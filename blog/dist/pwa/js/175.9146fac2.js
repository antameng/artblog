"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[175],{7175:(e,t,l)=>{l.r(t),l.d(t,{default:()=>be});var o=l(83673),a=l(62323);const n={class:"row justify-center"},i={key:0,style:{position:"fixed","margin-left":"-5rem",top:"140px","z-index":"2"}},s={key:1,class:"q-mb-lg"},r={class:"text-cyan-9",style:{"margin-top":"10px"}},m=["src"],c={class:"text-italic"},d={key:2,class:"q-mb-lg"},u={key:3,class:"q-mt-lg container"},p={key:4,class:"q-mt-lg"},g=(0,o._)("div",{class:"text-h6"},"目录",-1),w=["onClick"],f={style:{cursor:"pointer"}};function h(e,t,l,h,x,y){const _=(0,o.up)("q-btn"),C=(0,o.up)("q-avatar"),k=(0,o.up)("q-item-section"),v=(0,o.up)("q-item-label"),W=(0,o.up)("q-item"),b=(0,o.up)("q-skeleton"),q=(0,o.up)("q-scroll-observer"),D=(0,o.up)("v-md-preview"),Z=(0,o.up)("q-chip"),A=(0,o.up)("q-separator"),Q=(0,o.up)("Comment"),z=(0,o.up)("q-page"),I=(0,o.up)("q-card-section"),S=(0,o.up)("q-card");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(z,{padding:"",class:"col-xs-12",style:{width:"750px"}},{default:(0,o.w5)((()=>[e.$q.screen.gt.sm?((0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",null,[(0,o.Wm)(_,{style:{"margin-bottom":"1.667rem"},round:"",color:"primary",icon:"thumb_up_alt"})]),(0,o._)("div",null,[(0,o.Wm)(_,{style:{"margin-bottom":"1.667rem"},round:"",color:"primary",icon:"textsms"})])])):(0,o.kq)("",!0),e.onload?((0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("h4",r,(0,a.zw)(e.post.title),1),(0,o.Wm)(W,null,{default:(0,o.w5)((()=>[(0,o.Wm)(k,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{onClick:t[0]||(t[0]=t=>e.toRepositories(e.post.profile.id)),round:""},{default:(0,o.w5)((()=>[(0,o.Wm)(C,null,{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.post.profile.avatar},null,8,m)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.post.profile.name),1)])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o._)("code",c," Updated by "+(0,a.zw)(e.$store.getters.username)+" "+(0,a.zw)(e.post.CreatedAt),1)])),_:1})])),_:1})])),_:1})])):((0,o.wg)(),(0,o.iD)("div",d,[(0,o.Wm)(b,{width:"50%"}),(0,o.Wm)(b,{type:"text",width:"30%"})])),e.onload?((0,o.wg)(),(0,o.iD)("div",u,[(0,o.Wm)(q,{onScroll:h.onScroll},null,8,["onScroll"]),(0,o.Wm)(D,{text:e.post.content,ref:"preview"},null,8,["text"])])):((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(b,{type:"text"}),(0,o.Wm)(b,{type:"text"}),(0,o.Wm)(b,{type:"text"}),(0,o.Wm)(b,{type:"text"})])),(0,o._)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.post.labels,(t=>((0,o.wg)(),(0,o.j4)(Z,{outline:"",square:"",clickable:"",class:"label",key:t.index,style:(0,a.j5)(`border-color: #${t.color}; color: #${t.color};`),onClick:l=>e.chipClickHandler(t.name)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.name),1)])),_:2},1032,["style","onClick"])))),128))]),(0,o.Wm)(A,{color:"cyan-9",style:{height:"1px"}}),(0,o.Wm)(Q,{idss:e.post.id},null,8,["idss"])])),_:1}),e.$q.screen.gt.sm?((0,o.wg)(),(0,o.j4)(z,{key:0,style:{width:"250px",padding:"16px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{style:{position:"fixed",width:"218px",top:"inherit","z-index":"2"},flat:"",bordered:"",class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(I,null,{default:(0,o.w5)((()=>[g])),_:1}),(0,o.Wm)(A,{inset:""}),(0,o.Wm)(I,{ref:"title"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.titles,((t,l)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,a.C_)(`line${t.lineIndex}`),key:l,style:(0,a.j5)({padding:`10px 0 10px ${20*t.indent}px`}),onClick:l=>e.handleAnchorClick(t)},[(0,o._)("a",f,(0,a.zw)(t.title),1)],14,w)))),128))])),_:1},512)])),_:1})])),_:1})):(0,o.kq)("",!0)])}var x=l(61959);const y=["src"],_={class:"q-gutter-sm",style:{"margin-top":"0px"}},C=["onClick"],k={class:"text-bold"},v=(0,o.Uk)(" to join this conversation on GitHub. Already have an account? "),W=(0,o.Uk)("Sign in to comment"),b=["src"],q={class:"text-weight-bold"},D={class:"text-gray-light"},Z={class:"q-gutter-sm"},A={key:0},Q=["src"],z={class:"q-gutter-sm",style:{"margin-top":"0px"}},I=["onClick"],S=["src"],Y={class:"text-weight-bold"},$=(0,o._)("span",{class:"text-weight-bold"}," 回复：",-1),j={class:"text-gray-light"},H={class:"q-gutter-sm"},P={key:0},L=["src"],T={class:"q-gutter-sm",style:{"margin-top":"0px"}},E=["onClick"],M=(0,o._)("div",{class:"q-pa-md q-gutter-sm"},null,-1);function U(e,t,l,n,i,s){const r=(0,o.up)("q-avatar"),m=(0,o.up)("q-popup-edit"),c=(0,o.up)("q-btn"),d=(0,o.up)("q-input"),u=(0,o.up)("router-link"),p=(0,o.up)("q-card-section"),g=(0,o.up)("q-card"),w=(0,o.up)("q-item-section"),f=(0,o.up)("q-item-label"),h=(0,o.up)("q-badge"),x=(0,o.up)("q-item"),U=(0,o.up)("q-list");return(0,o.wg)(),(0,o.iD)("div",null,[e.logged?((0,o.wg)(),(0,o.j4)(d,{key:0,autogrow:"",modelValue:e.text,"onUpdate:modelValue":t[1]||(t[1]=t=>e.text=t),label:"Comment",dense:e.dense},{before:(0,o.w5)((()=>[(0,o.Wm)(r,{rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.meinfo.avatar},null,8,y)])),_:1})])),after:(0,o.w5)((()=>[(0,o.Wm)(c,{flat:"",round:"",color:"primary",icon:"mood"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{"max-width":"250px",style:{padding:"4px 8px"},self:"top start",cover:"false"},{default:(0,o.w5)((()=>[(0,o._)("div",_,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.faceList,((t,l)=>((0,o.wg)(),(0,o.iD)("a",{href:"javascript:void(0);",onClick:t=>e.getEmo(l),style:{"font-size":"22px","texttext-decoration":"none"},key:l,class:"emotionItem"},(0,a.zw)(t),9,C)))),128))])])),_:1})])),_:1}),(0,o.Wm)(c,{flat:"",color:"primary",class:"text-weight-bolder",onClick:t[0]||(t[0]=t=>e.addComment(0)),label:"comment"})])),_:1},8,["modelValue","dense"])):((0,o.wg)(),(0,o.j4)(g,{key:1,class:"bg-primary text-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o._)("div",k,[(0,o.Wm)(c,{push:"",color:"white",to:"/signup","text-color":"black",label:"Sign up for free"}),v,(0,o.Wm)(u,{class:"text-yellow-8 text-weight-bold",to:"/login",style:{color:"#fff"}},{default:(0,o.w5)((()=>[W])),_:1})])])),_:1})])),_:1})),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.comments,((l,n)=>((0,o.wg)(),(0,o.j4)(U,{bordered:"",class:"rounded-borders q-mt-lg",key:n},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:"q-pa-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{class:"cursor-pointer",onClick:t=>e.toRepositories(l.FromProfile.id),rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{alt:"avatar",src:l.FromProfile.avatar},null,8,b)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{lines:"1"},{default:(0,o.w5)((()=>[(0,o._)("span",q,(0,a.zw)(l.FromProfile.name)+"　",1),(0,o._)("span",D,(0,a.zw)(l.CreatedAt),1)])),_:2},1024),(0,o.Wm)(f,{style:{"word-break":"break-all"},innerHTML:l.content,class:"q-pt-sm"},null,8,["innerHTML"])])),_:2},1024),(0,o._)("div",Z,[e.logged?((0,o.wg)(),(0,o.j4)(c,{key:0,size:"10px",round:"",flat:"",color:"primary",icon:"comment",onClick:t=>e.commentss(n,null)},null,8,["onClick"])):(0,o.kq)("",!0),(0,o.Wm)(c,{size:"10px",round:"",flat:"",color:0==l.DiggArr.length?"#ccc":"red",icon:"favorite",onClick:t=>e.favorite(n,null,l.ID)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{color:0==l.DiggArr.length?"#ccc":"orange",rounded:"",floating:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(l.digg),1)])),_:2},1032,["color"])])),_:2},1032,["color","onClick"])])])),_:2},1024),l.isshow?((0,o.wg)(),(0,o.iD)("div",A,[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.meinfo.avatar},null,8,Q)])),_:1})])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{autogrow:"",modelValue:e.childtext,"onUpdate:modelValue":t[2]||(t[2]=t=>e.childtext=t),label:"回复："+l.FromProfile.name,dense:e.dense},{after:(0,o.w5)((()=>[(0,o.Wm)(c,{flat:"",round:"",color:"primary",icon:"mood"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{"max-width":"250px",style:{padding:"4px 8px"},self:"top start",cover:"false"},{default:(0,o.w5)((()=>[(0,o._)("div",z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.faceList,((t,l)=>((0,o.wg)(),(0,o.iD)("a",{href:"javascript:void(0);",onClick:t=>e.getEmo1(l),style:{"font-size":"22px","text-decoration":"none"},key:l,class:"emotionItem"},(0,a.zw)(t),9,I)))),128))])])),_:1})])),_:1}),(0,o.Wm)(c,{flat:"",class:"text-weight-bolder",color:"primary",onClick:t=>e.addComment(l.ID),label:"Comment"},null,8,["onClick"])])),_:2},1032,["modelValue","label","dense"])])),_:2},1024)])),_:2},1024)])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.CommentChild,((l,i)=>((0,o.wg)(),(0,o.j4)(U,{class:"q-mx-lg",key:i},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:"q-pa-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{class:"cursor-pointer",onClick:t=>e.toRepositories(l.FromProfile.id),rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{alt:"avatar",src:l.FromProfile.avatar},null,8,S)])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{lines:"1"},{default:(0,o.w5)((()=>[(0,o._)("span",Y,(0,a.zw)(l.FromProfile.name),1),$,(0,o._)("span",j,(0,a.zw)(l.ToProfile.name),1)])),_:2},1024),(0,o.Wm)(f,{style:{"word-break":"break-all"},innerHTML:l.content},null,8,["innerHTML"])])),_:2},1024),(0,o._)("div",H,[e.logged?((0,o.wg)(),(0,o.j4)(c,{key:0,size:"10px",round:"",flat:"",color:"primary",icon:"comment",onClick:t=>e.commentss(n,i)},null,8,["onClick"])):(0,o.kq)("",!0),(0,o.Wm)(c,{size:"10px",round:"",flat:"",color:0==l.DiggArr.length?"#ccc":"red",icon:"favorite",onClick:t=>e.favorite(n,i,l.ID)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{color:0==l.DiggArr.length?"#ccc":"orange",rounded:"",floating:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(l.digg),1)])),_:2},1032,["color"])])),_:2},1032,["color","onClick"])])])),_:2},1024),l.isshow?((0,o.wg)(),(0,o.iD)("div",P,[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{rounded:""},{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.meinfo.avatar},null,8,L)])),_:1})])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{autogrow:"",modelValue:e.childtext,"onUpdate:modelValue":t[3]||(t[3]=t=>e.childtext=t),label:"回复："+l.ToProfile.name,dense:e.dense},{after:(0,o.w5)((()=>[(0,o.Wm)(c,{flat:"",round:"",color:"primary",icon:"mood"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{"max-width":"250px",style:{padding:"4px 8px"},self:"top start",cover:"false"},{default:(0,o.w5)((()=>[(0,o._)("div",T,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.faceList,((t,l)=>((0,o.wg)(),(0,o.iD)("a",{href:"javascript:void(0);",onClick:t=>e.getEmo1(l),style:{"font-size":"22px","text-decoration":"none"},key:l,class:"emotionItem"},(0,a.zw)(t),9,E)))),128))])])),_:2},1024)])),_:2},1024),(0,o.Wm)(c,{flat:"",color:"primary",class:"text-weight-bolder",onClick:t=>e.addComment(l.ID),label:"Comment"},null,8,["onClick"])])),_:2},1032,["modelValue","label","dense"])])),_:2},1024)])),_:2},1024)])):(0,o.kq)("",!0)])),_:2},1024)))),128))])),_:2},1024)))),128)),M])}var K=l(78114),V=l(80589),F=l(64434),B=l(21082),R=l(10011),N=l(43359),O=l(79582);const G={name:"Comment",components:{},props:{idss:{type:String,required:!0}},setup(){let e=(0,x.qj)({meinfo:{},logged:!1,marktext:"",faceList:[],text:"",childtext:"",isshow:!1,isfav:!1,isshowindex:0,isshowindex1:0,comments:[]});const t=(0,O.yj)(),l=(0,O.tv)(),a={commentss(t,l){e.childtext="",null==l?(0!=e.comments[e.isshowindex].CommentChild.length&&(e.comments[e.isshowindex].CommentChild[e.isshowindex1].isshow=!1),e.comments[e.isshowindex].isshow=!1,e.comments[t].isshow=!0,e.isshowindex=t):(e.comments[e.isshowindex].CommentChild[e.isshowindex1].isshow=!1,e.comments[e.isshowindex].isshow=!1,e.comments[t].CommentChild[l].isshow=!0,e.isshowindex=t,e.isshowindex1=l)},toRepositories(e){l.push(`/repository/${e}`)},async favorite(t,l,o){const a={comment_id:o};if(null==l)if(0==e.comments[t].DiggArr.length){let l=await(0,R.sh)(a);200==l.status&&(e.comments[t].DiggArr[0]=!0,e.comments[t].digg++)}else{let l=await(0,R.uc)(a);200==l.status&&(e.comments[t].DiggArr=[],e.comments[t].digg--)}else if(0==e.comments[t].CommentChild[l].DiggArr.length){let o=await(0,R.sh)(a);200==o.status&&(e.comments[t].CommentChild[l].DiggArr[0]=!0,e.comments[t].CommentChild[l].digg++)}else{let o=await(0,R.uc)(a);200==o.status&&(e.comments[t].CommentChild[l].DiggArr=[],e.comments[t].CommentChild[l].digg--)}},async getTalk(){"yes"===V.Z.getItem("logged_in")&&(e.logged=!0);const l={pagenum:1,pagesize:10};let o=await(0,N.nQ)(t.params.id,l);null!=o.data&&(e.comments=o.data.map((e=>{e.isshow=!1;let t=new Date(e.CreatedAt),l=B.ZP.formatDate(t,"YYYY-MM-DD HH:mm:ss");e.CreatedAt=l;const o=e.CommentChild;return null!=o&&0!=o.length&&o.forEach((e=>{e.isshow=!1;let t=new Date(e.CreatedAt),l=B.ZP.formatDate(t,"YYYY-MM-DD HH:mm:ss");e.CreatedAt=l})),e})))},async addComment(l){let o={article_id:1e3*t.params.id/1e3,content:e.text,comment_id:0};if(0!=l?(o.content=e.childtext,o.comment_id=l):delete o.comment_id,""==o.content)return void F.Z.create({message:"comment can't be empty",color:"negative",icon:"report_problem",position:"top",timeout:2e3});let n=await(0,R.Ir)(o);200==n.status&&(e.text="",e.childtext=""),await a.getTalk()},getEmo(t){const l=e.faceList[t];e.text=e.text+l},getEmo1(t){const l=e.faceList[t];e.childtext=e.childtext+l},async getEmo2(){}};return(0,o.bv)((async()=>{e.meinfo.avatar=V.Z.getItem("avatar"),await a.getTalk(),K.forEach((t=>{e.faceList.push(t.char)}))})),{...(0,x.BK)(e),...a}}};var J=l(74260),X=l(64689),ee=l(75096),te=l(2165),le=l(61289),oe=l(83944),ae=l(10151),ne=l(25589),ie=l(27011),se=l(83414),re=l(52035),me=l(2350),ce=l(69721),de=l(24554),ue=l(7518),pe=l.n(ue);const ge=(0,J.Z)(G,[["render",U]]),we=ge;pe()(G,"components",{QInput:X.Z,QAvatar:ee.Z,QBtn:te.Z,QPopupEdit:le.Z,QPopupProxy:oe.Z,QCard:ae.Z,QCardSection:ne.Z,QList:ie.Z,QItem:se.Z,QItemSection:re.Z,QItemLabel:me.Z,QBadge:ce.Z,QIcon:de.Z});var fe=l(46841),he=l.n(fe);const xe={name:"Post",components:{Comment:we},setup(){const e=(0,O.yj)(),t=(0,O.tv)();let l=(0,x.qj)({onload:!1,post:{id:"",title:"",CreatedAt:"",content:"",profile:null},titles:[],isActive:!0,closetitle:null});const{ctx:a}=(0,o.FN)(),n={async commentss(){let t=await(0,R.fq)(e.params.id);l.onload=!0,l.post.content=t.data.content,l.post.id=t.data.ID,l.post.title=t.data.title;let o=new Date(t.data.CreatedAt),a=B.ZP.formatDate(o,"YYYY-MM-DD HH:mm:ss");l.post.CreatedAt=a,l.post.profile=t.data.Profile},toRepositories(e){t.push(`/repository/${e}`)},handleAnchorClick(e){const{preview:t}=a.$refs,{lineIndex:l}=e,o=t.$el.querySelector(`[data-v-md-line="${String(l)}"]`);o&&t.scrollToTarget({target:o,scrollContainer:window,top:60})}};return(0,o.bv)((async()=>{await n.commentss(),await(0,o.Y3)((()=>{const e=a.$refs.preview.$el.querySelectorAll("h1,h2,h3,h4,h5,h6"),t=Array.from(e).filter((e=>!!e.innerText.trim()));if(!t.length)return void(l.titles=[]);const o=Array.from(new Set(t.map((e=>e.tagName)))).sort();console.log(o),he()(".container",(function(){console.log("所有图片加载完成!"),l.titles=t.map((e=>({title:e.innerText,lineIndex:e.getAttribute("data-v-md-line"),indent:o.indexOf(e.tagName),top:e.offsetTop})))}))}))})),{...(0,x.BK)(l),...n,onScroll(e){var t=Number(e.position.top)+10;if(l.titles.forEach((e=>{const o=a.$refs.title.$el.querySelector(`.line${String(e.lineIndex)}`);o.style.backgroundColor="",t>=e.top&&(l.closetitle=e)})),l.closetitle){const e=a.$refs.title.$el.querySelector(`.line${String(l.closetitle.lineIndex)}`);e.style.backgroundColor="#d2eaf9"}}}}};var ye=l(24379),_e=l(54103),Ce=l(4303),ke=l(67030),ve=l(65869);const We=(0,J.Z)(xe,[["render",h]]),be=We;pe()(xe,"components",{QPage:ye.Z,QBtn:te.Z,QItem:se.Z,QItemSection:re.Z,QAvatar:ee.Z,QItemLabel:me.Z,QSkeleton:_e.ZP,QScrollObserver:Ce.Z,QChip:ke.Z,QSeparator:ve.Z,QCard:ae.Z,QCardSection:ne.Z})}}]);