"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[352],{10011:(t,e,a)=>{a.d(e,{x4:()=>l,a_:()=>i,P1:()=>n,IU:()=>s,Ai:()=>c,cc:()=>p,jC:()=>r,pk:()=>d,bp:()=>u,fq:()=>m,qM:()=>g,nQ:()=>_,Ir:()=>w,sh:()=>b,uc:()=>y,bb:()=>f,Ix:()=>x,Uf:()=>v,Yq:()=>h});var o=a(11768);const l=async t=>await o.api.post("/api/login/users",t),i=async t=>await o.api.get("/api/login/checktoken",{params:t}),n=async t=>await o.api.post("/api/login/sendvalidator",t),s=async t=>await o.api.post("/api/blog/signup",t),c=async t=>await o.api.get(`/api/blog/profile/${t}`),p=async()=>await o.api.get("/api/blog/getme"),r=async t=>await o.api.get("/api/blog/articlelist",{params:t}),d=async t=>await o.api.get("/api/blog/category",{params:t}),u=async t=>await o.api.get("/api/blog/me/articlelist",{params:t}),m=async t=>await o.api.get(`/api/blog/article/${t}`),g=async t=>await o.api.post("/api/blog/article",t),_=async(t,e)=>await o.api.get(`/api/blog/comment/list/${t}`,{params:e}),w=async t=>await o.api.post("/api/blog/comment",t),b=async t=>await o.api.post("/api/blog/comment/digg",t),y=async t=>await o.api.post("/api/blog/comment/undigg",t),f=async t=>await o.api["delete"](`/api/blog/article/${t}`),x=async t=>{const e={headers:{"Content-Type":"multipart/form-data"}};return await o.api.post("/api/blog/upload",t,e)},v=async t=>{const e={headers:{"Content-Type":"multipart/form-data"}};return await o.api.post("/api/blog/avatar/upload",t,e)},h=async t=>await o.api.post("/api/blog/emoji",t)},81352:(t,e,a)=>{a.r(e),a.d(e,{default:()=>j});var o=a(83673),l=a(62323);const i={class:"row justify-center"},n=(0,o._)("img",{src:"https://cdn.quasar.dev/logo-v2/svg/logo.svg"},null,-1),s=(0,o._)("span",{class:"text-weight-bold"},"Quasar",-1),c=(0,o.Uk)(" Framework");function p(t,e,a,p,r,d){const u=(0,o.up)("q-btn"),m=(0,o.up)("q-input"),g=(0,o.up)("v-md-editor"),_=(0,o.up)("v-md-preview"),w=(0,o.up)("q-avatar"),b=(0,o.up)("q-toolbar-title"),y=(0,o.up)("q-toolbar"),f=(0,o.up)("q-uploader"),x=(0,o.up)("q-chip"),v=(0,o.up)("q-card-section"),h=(0,o.up)("q-form"),k=(0,o.up)("q-card-actions"),C=(0,o.up)("q-card"),q=(0,o.up)("q-dialog"),W=(0,o.up)("q-page"),Z=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(W,{padding:"",class:"col-xs-12 col-sm-10"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{autogrow:"",modelValue:t.title_text,"onUpdate:modelValue":e[2]||(e[2]=e=>t.title_text=e),label:"title",dense:t.dense},{after:(0,o.w5)((()=>[0==t.content_status?((0,o.wg)(),(0,o.j4)(u,{key:0,push:"",color:"primary",onClick:e[0]||(e[0]=e=>t.save(0)),label:"Save"})):(0,o.kq)("",!0),(0,o.Wm)(u,{push:"",color:"primary",onClick:e[1]||(e[1]=e=>t.commentAlert()),label:"Comment"})])),_:1},8,["modelValue","dense"]),(0,o.Wm)(g,{modelValue:t.content_text,"onUpdate:modelValue":e[3]||(e[3]=e=>t.content_text=e),height:"90%","disabled-menus":[],onUploadImage:t.handleUploadImage},null,8,["modelValue","onUploadImage"]),(0,o.Wm)(_,{text:t.marktext},null,8,["text"]),(0,o.Wm)(q,{modelValue:t.alert,"onUpdate:modelValue":e[6]||(e[6]=e=>t.alert=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{style:{width:"300px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[s,c])),_:1}),(0,o.wy)((0,o.Wm)(u,{flat:"",round:"",dense:"",icon:"close"},null,512),[[Z]])])),_:1}),(0,o.Wm)(v,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{onAdded:t.addImage,style:{width:"initial!important"},"hide-upload-btn":"false",flat:"",bordered:""},null,8,["onAdded"]),(0,o._)("div",{style:{"max-width":"300px"},class:(0,l.C_)({"truncate-chip-labels":t.truncate})},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.select_tag,((e,a)=>((0,o.wg)(),(0,o.j4)(x,{removable:"",class:"label",color:e.color,"text-color":e.text_color,icon:e.icon,key:a,onRemove:e=>t.removeChipClickHandler(a)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.name),1)])),_:2},1032,["color","text-color","icon","onRemove"])))),128))],2)])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{onSubmit:t.onSubmit,class:"q-gutter-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{outlined:"",dense:"",modelValue:t.category_text,"onUpdate:modelValue":e[4]||(e[4]=e=>t.category_text=e),label:"Label"},null,8,["modelValue"])])),_:1},8,["onSubmit"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.unselect_tag,((e,a)=>((0,o.wg)(),(0,o.j4)(x,{clickable:"",class:"label",color:e.color,"text-color":e.text_color,icon:e.icon,key:a,onClick:e=>t.addChipClickHandler(a)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.name),1)])),_:2},1032,["color","text-color","icon","onClick"])))),128))])),_:1}),(0,o.Wm)(k,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(u,{flat:"",label:"OK",onClick:e[5]||(e[5]=e=>t.save(1)),color:"primary"},null,512),[[Z]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])}var r=a(64434),d=a(10011),u=a(61959),m=a(95121),g=a(79582);const _={name:"Post",components:[m.AK],setup(){let t=(0,u.qj)({options:{img:"",autoCrop:!0,fixedBox:!1,canMoveBox:!0,autoCropWidth:200,autoCropHeight:200,fixed:!0,fixedNumber:[1,1],centerBox:!0,canMove:!1,canScale:!1},vanilla:!0,chocolate:!0,strawberry:!0,cookies:!0,alert:!1,title_text:"",content_text:"",content_img:"",content_id:0,content_status:0,select_tag:[],unselect_tag:[],category_text:""});const e=(0,g.yj)(),a=(0,g.tv)(),{ctx:l}=(0,o.FN)();console.log(l);const i={onSubmit(){t.select_tag.push({name:t.category_text})},addChipClickHandler(e){t.select_tag.push(t.unselect_tag[e]),t.unselect_tag.splice(e,1)},removeChipClickHandler(e){void 0!=t.select_tag[e].id&&t.unselect_tag.push(t.select_tag[e]),t.select_tag.splice(e,1)},async commentAlert(){t.alert=!0;const e={pagenum:1,pagesize:20};let a=await(0,d.pk)(e);t.unselect_tag=a.data,t.select_tag=[]},async save(o){if(""===t.title_text)return void r.Z.create({message:"请填写title",color:"negative",icon:"report_problem",position:"top",timeout:2e3});if(""===t.content_text)return void r.Z.create({message:"请填写content",color:"negative",icon:"report_problem",position:"top",timeout:2e3});let l={title:t.title_text,content:t.content_text,status:o,id:t.content_id,img:t.content_img},i=await(0,d.qM)(l);if(200==i.status)if(0==i.data.status){if(0==t.content_id){let a=i.data.ID,o=e.path;history.replaceState("","","#"+o+"/"+a),t.content_id=i.data.ID}r.Z.create({message:"Save Successful",color:"positive",icon:"report_problem",position:"top",timeout:3e3})}else r.Z.create({message:"Publish Successful",type:"positive",position:"top",timeout:5e3,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),a.go(-1);console.log(i)},async commentss(e){let a=await(0,d.fq)(e);console.log(a),void 0!=a&&(t.content_status=a.data.status,t.content_id=a.data.ID,t.title_text=a.data.title,t.content_text=a.data.content)},async handleUploadImage(t,e,a){let o=new FormData;o.append("file",a[0]);let l=await(0,d.Ix)(o);200==l.status&&e({url:l.url,desc:"七龙珠"})},async addImage(e){let a=new FormData;a.append("file",e[0]);let o=await(0,d.Ix)(a);200==o.status&&(t.content_img=o.url)}};return(0,o.wF)((async()=>{await i.commentss(e.params.id)})),{...(0,u.BK)(t),...i}}};var w=a(74260),b=a(24379),y=a(64689),f=a(2165),x=a(46778),v=a(10151),h=a(39570),k=a(75096),C=a(13747),q=a(25589),W=a(2046),Z=a(67030),Q=a(68689),I=a(99367),U=a(60677),V=a(7518),S=a.n(V);const D=(0,w.Z)(_,[["render",p]]),j=D;S()(_,"components",{QPage:b.Z,QInput:y.Z,QBtn:f.Z,QDialog:x.Z,QCard:v.Z,QToolbar:h.Z,QAvatar:k.Z,QToolbarTitle:C.Z,QCardSection:q.Z,QUploader:W.Z,QChip:Z.Z,QForm:Q.Z,QCardActions:I.Z}),S()(_,"directives",{ClosePopup:U.Z})}}]);