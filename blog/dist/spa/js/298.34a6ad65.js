"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[298],{14298:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var o=a(83673),l=a(62323);const n={class:"row justify-center"},c=(0,o._)("img",{src:"https://cdn.quasar.dev/logo-v2/svg/logo.svg"},null,-1),s=(0,o._)("span",{class:"text-weight-bold"},"Quasar",-1),i=(0,o.Uk)(" Framework");function r(e,t,a,r,d,u){const m=(0,o.up)("q-btn"),p=(0,o.up)("q-input"),g=(0,o.up)("v-md-editor"),_=(0,o.up)("q-avatar"),w=(0,o.up)("q-toolbar-title"),x=(0,o.up)("q-toolbar"),f=(0,o.up)("q-uploader"),h=(0,o.up)("q-chip"),b=(0,o.up)("q-card-section"),v=(0,o.up)("q-form"),C=(0,o.up)("q-card-actions"),y=(0,o.up)("q-card"),k=(0,o.up)("q-dialog"),q=(0,o.up)("q-page"),Z=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(q,{padding:"",class:"col-xs-12 col-sm-10"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{autogrow:"",modelValue:e.title_text,"onUpdate:modelValue":t[2]||(t[2]=t=>e.title_text=t),label:"title",dense:e.dense},{after:(0,o.w5)((()=>[0==e.content_status?((0,o.wg)(),(0,o.j4)(m,{key:0,push:"",color:"primary",onClick:t[0]||(t[0]=t=>e.save(0)),label:"Save"})):(0,o.kq)("",!0),(0,o.Wm)(m,{push:"",color:"primary",onClick:t[1]||(t[1]=t=>e.commentAlert()),label:"Comment"})])),_:1},8,["modelValue","dense"]),(0,o.Wm)(g,{modelValue:e.content_text,"onUpdate:modelValue":t[3]||(t[3]=t=>e.content_text=t),height:"90%","disabled-menus":[],onUploadImage:e.handleUploadImage},null,8,["modelValue","onUploadImage"]),(0,o.Wm)(k,{modelValue:e.alert,"onUpdate:modelValue":t[6]||(t[6]=t=>e.alert=t)},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{style:{width:"300px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[c])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[s,i])),_:1}),(0,o.wy)((0,o.Wm)(m,{flat:"",round:"",dense:"",icon:"close"},null,512),[[Z]])])),_:1}),(0,o.Wm)(b,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{onAdded:e.addImage,style:{width:"initial!important"},"hide-upload-btn":"false",flat:"",bordered:""},null,8,["onAdded"]),(0,o._)("div",{style:{"max-width":"300px"},class:(0,l.C_)({"truncate-chip-labels":e.truncate})},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.select_tag,((t,a)=>((0,o.wg)(),(0,o.j4)(h,{removable:"",class:"label",color:t.color,"text-color":t.text_color,icon:t.icon,key:a,onRemove:t=>e.removeChipClickHandler(a)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.name),1)])),_:2},1032,["color","text-color","icon","onRemove"])))),128))],2)])),_:1}),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{onSubmit:e.onSubmit,class:"q-gutter-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{outlined:"",dense:"",modelValue:e.category_text,"onUpdate:modelValue":t[4]||(t[4]=t=>e.category_text=t),label:"Label"},null,8,["modelValue"])])),_:1},8,["onSubmit"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.unselect_tag,((t,a)=>((0,o.wg)(),(0,o.j4)(h,{clickable:"",class:"label",color:t.color,"text-color":t.text_color,icon:t.icon,key:a,onClick:t=>e.addChipClickHandler(a)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.name),1)])),_:2},1032,["color","text-color","icon","onClick"])))),128))])),_:1}),(0,o.Wm)(C,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(m,{flat:"",label:"OK",onClick:t[5]||(t[5]=t=>e.save(1)),color:"primary"},null,512),[[Z]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])}var d=a(64434),u=a(10011),m=a(61959),p=a(79582),g=a(43410),_=a.n(g);const w={name:"Post",setup(){let e=(0,m.qj)({options:{img:"",autoCrop:!0,fixedBox:!1,canMoveBox:!0,autoCropWidth:200,autoCropHeight:200,fixed:!0,fixedNumber:[1,1],centerBox:!0,canMove:!1,canScale:!1},vanilla:!0,chocolate:!0,strawberry:!0,cookies:!0,alert:!1,title_text:"",content_text:"",content_img:"",content_id:0,content_status:0,select_tag:[],unselect_tag:[],category_text:""});const t=(0,p.yj)(),a=(0,p.tv)(),{ctx:l}=(0,o.FN)(),n={onSubmit(){e.select_tag.push({name:e.category_text})},addChipClickHandler(t){e.select_tag.push(e.unselect_tag[t]),e.unselect_tag.splice(t,1)},removeChipClickHandler(t){void 0!=e.select_tag[t].id&&e.unselect_tag.push(e.select_tag[t]),e.select_tag.splice(t,1)},async commentAlert(){e.alert=!0;const t={pagenum:1,pagesize:20};let a=await(0,u.pk)(t);e.unselect_tag=a.data,a.data.forEach(((t,a)=>{const o=e.select_tag.findIndex((e=>e.id===t.id));-1!==o&&e.unselect_tag.splice(a,1)}))},async save(t){if(""===e.title_text)return void d.Z.create({message:"title can't be empty",color:"negative",icon:"report_problem",position:"top",timeout:2e3});if(""===e.content_text)return void d.Z.create({message:"content can't be empty",color:"negative",icon:"report_problem",position:"top",timeout:2e3});let o=[];e.select_tag.forEach(((t,a)=>{void 0!==t.id&&(t.name=""),o.push({ID:e.content_id,Cid:t.id,Category:{name:t.name}})}));let l={title:e.title_text,content:e.content_text,status:t,id:e.content_id,img:e.content_img,desc:g.xss.process(_().vMdParser.themeConfig.markdownParser.render(e.content_text)),cateart:o},n=await(0,u.qM)(l);200==n.status&&(0==n.data.status?(0==e.content_id&&(e.content_id=n.data.ID),d.Z.create({message:"Save Successful",color:"positive",icon:"report_problem",position:"top",timeout:3e3})):(d.Z.create({message:"Publish Successful",type:"positive",position:"top",timeout:5e3,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),a.go(-1)))},async commentss(t){let a=await(0,u.fq)(t);void 0!=a&&(e.content_status=a.data.status,e.content_id=a.data.ID,e.title_text=a.data.title,e.content_text=a.data.content,a.data.Cateart.forEach(((t,a)=>{e.select_tag.push(t.Category)})))},async handleUploadImage(e,t,a){let o=new FormData;o.append("file",a[0]);let l=await(0,u.Ix)(o);200==l.status&&t({url:l.url,desc:"在这里插入图片描述"})},async addImage(t){let a=new FormData;a.append("file",t[0]);let o=await(0,u.Ix)(a);200==o.status&&(e.content_img=o.url)}};return(0,o.wF)((async()=>{await n.commentss(t.params.id)})),{...(0,m.BK)(e),...n}}};var x=a(74260),f=a(24379),h=a(64689),b=a(2165),v=a(46778),C=a(10151),y=a(39570),k=a(75096),q=a(13747),Z=a(25589),W=a(2046),Q=a(67030),I=a(68689),U=a(99367),V=a(60677),D=a(7518),S=a.n(D);const H=(0,x.Z)(w,[["render",r]]),j=H;S()(w,"components",{QPage:f.Z,QInput:h.Z,QBtn:b.Z,QDialog:v.Z,QCard:C.Z,QToolbar:y.Z,QAvatar:k.Z,QToolbarTitle:q.Z,QCardSection:Z.Z,QUploader:W.Z,QChip:Q.Z,QForm:I.Z,QCardActions:U.Z}),S()(w,"directives",{ClosePopup:V.Z})}}]);